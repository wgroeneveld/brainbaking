<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>cmd</title>
  
  <meta name="author" content="Wouter Groeneveld"/>
  <meta name="generator" content="Hugo 0.18.1" />
  <link href='http://www.brainbaking.com//img/favicon.ico' rel='icon' type='image/x-icon'/>

  <link rel="alternate" href="http://www.brainbaking.com/index.xml" type="application/rss+xml" title="Brain Baking">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="http://www.brainbaking.com//css/bootstrap.min.css" />
  <link rel="stylesheet" href="http://www.brainbaking.com//css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="http://www.brainbaking.com//css/pygment_highlights.css" />
  <link rel="stylesheet" href="http://www.brainbaking.com/css/highlight.min.css">
  
  
  <meta property="og:title" content="cmd" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/wiki/unix/cmd/" />
  <meta property="og:image" content="/img/avatar-icon.png" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://www.brainbaking.com/">
        <i class="fa fa-lightbulb-o" aria-hidden="true"></i>&nbsp;&nbsp;
        Brain Baking
      </a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      <li id="google-search-wrapper">
	<script>
	(function() {
	  var cx = '015035874764642922467:uhhwew4ykvm';
	  var gcse = document.createElement('script');
	  gcse.type = 'text/javascript';
	  gcse.async = true;
	  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	  var s = document.getElementsByTagName('script')[0];
	  s.parentNode.insertBefore(gcse, s);
	})();
	</script>

	<gcse:search></gcse:search>

	<form onsubmit="return false;">
		<label for="searchInput"><i class="fa fa-search" aria-hidden="true"></i><span class="sr-only">Search</span></label>
		<input type="text" id="searchInput" placeholder="Search">
	</form>

	<script>
	(function() {
		document.querySelector('#searchInput').addEventListener("keypress", function(event) {
			if(event.keyCode === 13) {
				event.stopPropagation();
				document.querySelector('#___gcse_0 input').value = document.querySelector('#searchInput').value;
				document.querySelector('.gsc-search-button input').click();

				var modal = document.querySelector('.gsc-modal-background-image');
				modal.attributes['class'].value = "gsc-modal-background-image gsc-modal-background-image-visible";
			}
		});
	})();
	</script>
</li>

      
        
          <li>
          <a title="Blog" href="/">Blog</a>
  	      </li>
  	    
      
        
          <li>
          <a title="Wiki" href="/wiki/">Wiki</a>
  	      </li>
  	    
      
        
          <li>
          <a title="About me" href="/about">About me</a>
  	      </li>
  	    
      
      </ul>
    </div>

	<div class="avatar-container">
	  <div class="avatar-img-border">
      
          <a title="Brain Baking" href="http://www.brainbaking.com/">
              <img class="avatar-img" src="http://www.brainbaking.com//img/avatar-icon.png" alt="Brain Baking" />
          </a>
      
	  </div>
	</div>

  </div>
</nav>

    



  

  <header class="header-section ">
  
  <div class="intro-header no-img">
      <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="wiki-heading">
          <h1>cmd</h1>
      
      
      
        </div>
      </div>
    </div>
  </div>
  </div>
  </header>


    <div class="container" role="main">	  
      
        
  <i class="fa fa-tags" style="float: left;" aria-hidden="true"></i>
  <ul id="tags">
  
   <li><a href="/tags/unix">unix</a> </li>
  
   <li><a href="/tags/cmd">cmd</a> </li>
  
  </ul>


        

<h1 id="unix-commandline-stuff">Unix Commandline Stuff</h1>

<h3 id="binaries-zoeken">Binaries zoeken</h3>

<p>Kan met <code>whereis</code>, <strong>maar</strong> die zoekt blijkbaar niet in &ldquo;alle&rdquo; binary dirs - enkel degene die geconfigureerd zijn onder:</p>

<pre><code>sysctl user.cs_path
# output: user.cs_path = /usr/bin:/bin:/usr/sbin:/sbin
</code></pre>

<h3 id="shell-automatisation">Shell automatisation</h3>

<p>Command-line programs <em>feeden</em> kan met het <code>expect</code> tooltje. Bijvoorbeeld, bij het aanloggen in <code>ssh</code> moet je daarna een wachtwoord geven en op enter drukken dat niet als commandline argument meegegeven kan worden. Dit kan je dan zo forceren:</p>

<pre><code>#!/usr/bin/expect -f
# Expect script to supply root/admin password for remote ssh server 
# and execute command.
# This script needs three argument to(s) connect to remote server:
# password = Password of remote UNIX server, for root user.
# ipaddr = IP Addreess of remote UNIX server, no hostname
# scriptname = Path to remote script which will execute on remote server
# For example:
#  ./sshlogin.exp password 192.168.1.11 who 
# ------------------------------------------------------------------------
# Copyright (c) 2004 nixCraft project &lt;http://cyberciti.biz/fb/&gt;
# This script is licensed under GNU GPL version 2.0 or above
# -------------------------------------------------------------------------
# This script is part of nixCraft shell script collection (NSSC)
# Visit http://bash.cyberciti.biz/ for more information.
# ----------------------------------------------------------------------
# set Variables
set password [lrange $argv 0 0] 
set ipaddr [lrange $argv 1 1]   
set username [lrange $argv 2 2] 
set timeout -1   
# now connect to remote UNIX box (ipaddr) with given script to execute
spawn ssh $username@$ipaddr
match_max 100000
# Look for passwod prompt
expect &quot;*?assword:*&quot;
# Send password aka $password 
send -- &quot;$password&lt;br/&gt;r&quot;
# send blank line (&lt;br/&gt;r) to make sure we get back to gui
send -- &quot;&lt;br/&gt;r&quot;
expect eof
</code></pre>

<p>(<a href="http://nixcraft.com/shell-scripting/4489-ssh-passing-unix-login-passwords-through-shell-scripts.html">bron</a>) - voor meer uitleg zie <a href="https://en.wikipedia.org/wiki/Expect" target="_blank">Expect</a>
 wiki.</p>

<h3 id="synchronizing-backupping-file-copying">Synchronizing/backupping/file copying</h3>

<p>Gebruik het <code>rsync</code> commando om incrementeel een kopie te nemen van een directory en alle subdirs van plaats1 naar plaats2. Dit kan lokaal, naar een externe HDD of zelfs via een server. <code>rsync</code> heeft ook een daemon mode die je aan kan zetten met <code>--daemon</code> - Zie <a href="http://www.samba.org/ftp/rsync/rsync.html">rsync man</a>. Het belangrijkste commando is zonder twijfel:</p>

<pre><code>$ rsync -auv -E -W --del [src] [dest]
</code></pre>

<p>Opties:</p>

<ul>
<li><code>-a</code>: archive mode: auto-enable een hoop andere opties (keep timestamps etc)</li>
<li><code>-u</code>: update (incremental mode)</li>
<li><code>-v</code>: verbose</li>
<li><code>-E</code>: preserve executability (niet nodig onder windows)</li>
<li><code>--del</code>: delete files die in de source verdwijnen ook in de destination.</li>
</ul>

<p>Een extra optie <code>-z</code> kan ook compressie over netwerk toevoegen. Verwijder dan best <code>-W</code>.</p>

<p>Je kan periodiek dit commando uit voeren om de destination dir up-to-date te houden. Vergeet niet dat rsync ook een <code>daemon</code> mode heeft, met nog veel meer opties!</p>

<h3 id="user-rechten-geven-om-root-te-worden">User rechten geven om root te worden</h3>

<p>Probleem bij <code>su</code> commando: <em>su: Sorry for normal user account.</em></p>

<p>Vergeten toe te voegen aan de <code>wheel</code> user group, zo doen:</p>

<p><code>pw user mod vivek -G wheel</code></p>

<h3 id="shell-editing-mode">Shell editing mode</h3>

<p>Zie <a href="http://www.catonmat.net/blog/bash-vi-editing-mode-cheat-sheet/">http://www.catonmat.net/blog/bash-vi-editing-mode-cheat-sheet/</a></p>

<pre><code>$ set -o vi
</code></pre>

<p>Best opslaan in uw <code>.bashrc</code> (of whateverrc)</p>

<p>-&gt; Tof om te weten: <code>CTRL+L</code> <strong>cleart het scherm</strong> van een <strong>terminal</strong> (dit werkt ook voor Cygwin!)</p>

<h3 id="command-history">Command History</h3>

<p>voorbeeld:</p>

<pre><code>dir $ history
   1 ls -la
   2 cd ~
   3 rm somedir
dir $ !2
~ $ !!
</code></pre>

<p>waarbij ![getal] laatste x commando uitvoert en !! het laatste. Zie <code>man history</code> voor geavanceerde voorbeelden.</p>

<h3 id="copy-and-auto-create-dir-structure">Copy and auto-create dir structure</h3>

<p>Bewaar dit shell script naar cpi.sh:</p>

<pre><code class="language-bash">#!/bin/bash
if [ ! -d &quot;$2&quot; ]; then
    mkdir -p &quot;$2&quot;
fi
cp -R &quot;$1&quot; &quot;$2&quot;
</code></pre>

<p><code>chmod +x cpi.sh</code> en dan in uw <code>.bashrc</code> een link leggen om <code>cpi</code> te gebruiken.</p>

<h3 id="xargs">xargs</h3>

<p>Het bovenstaande kan ook uitgevoerd worden met <code>xargs</code> en piping. Bijvoorbeeld bepaalde bestanden (niet-recursief) kopiëren naar &ldquo;tmp&rdquo;:</p>

<pre><code>ls | grep .php | xargs -i cp {} ./tmp
</code></pre>

<p>Andere interessante opties van xargs:</p>

<ul>
<li><code>-ix</code>: gebruik <code>{}</code> (of <code>x</code> karakters indien specified) om lijn per lijn de input te vervangen. Het kan zijn dat dit escaped moet worden met backslashen voor de shell!</li>
<li><code>-0</code>: gebruik in combinatie met <code>-print0</code> en <code>find</code> om het verschil tussen spaties en newlines duidelijk te maken</li>
<li><code>-p</code>: confirm elke actie, interessant bij verwijderen van crutiale files</li>
<li><code>-lx</code>: gebruik maximum x lijnen input per command line.</li>
<li><code>-nx</code>: gebruik maximum x argumenten per command line.</li>
<li><code>-t</code>: verbose mode (<code>--verbose</code> werkt ook)</li>
</ul>

<h3 id="sed">sed</h3>

<p>Gebruik <code>sed</code> om snel replaces te doen door middel van regex, of door lines te nummeren, &hellip; <br/><br/>
Het is ook mogelijk om regex partities te <em>groeperen</em>, vergeet niet de haakjes zelf te escapen! Om de gegroepeerde waarde in het &ldquo;replace&rdquo; geteelde te gebruiken, moeten we niet <code>$1</code> maar <code>&lt;br/&gt;1</code> gebruiken. Bijvoorbeeld:</p>

<pre><code>sed 's/&lt;br/&gt;(.*&lt;br/&gt;)/regel:&lt;br/&gt;1/g' log.tmp &gt;&gt; $logfile
</code></pre>

<p>Resultaat:</p>

<ol>
<li>Replace x door y via <code>s/regex/replace/</code></li>
<li>Replace alle gevonden instanties (<code>g</code> na expressie)</li>
<li>Groepeer alles door te zoeken op <code>.*</code> en er haakjes rond te plaatsen</li>
<li>Vervang alles door &lsquo;regel:&rsquo; + alles van de groep</li>
</ol>

<p>Dus prepend elke regel met &lsquo;regel:&lsquo;.</p>

<p>-&gt; Groeperen in sed vereist escaped parentheses, anders matchen we exact <code>(</code> in de zoekstring zelf!</p>

<h5 id="chainen">chainen</h5>

<p>Een keer sed aanroepen en in een sequentie meerdere replaces doen gaat met het <code>-e</code> argument (script mode):</p>

<pre><code>cat file | sed -e 's/replace/by/g' -e 's/other/new/g' 
</code></pre>

<h5 id="aan-begin-van-lijnen-prependen">Aan begin van lijnen prependen</h5>

<p>Gebruik het symbool &lsquo;^&rsquo; om het begin van een lijn te matchen, en &lsquo;$&rsquo; om het einde van een lijn te matchen:</p>

<pre><code>cat file | sed 's/^&lt;br/&gt;([^=]&lt;br/&gt;)/  *&lt;br/&gt;1/'
</code></pre>

<p>Hier wordt in het begin van elke lijn spatie spatie ster toegevoegd behalve als de lijn begint met het gelijkheidsteken. Omdat we anders het eerste karakter vervangen moeten we die ook capturen!</p>

<p>-&gt; Zoals in eclipse een getal matchen met <code>&lt;br/&gt;d</code> werkt niet, daarvoor moet je <code>[0-9]</code> gebruiken.</p>

<h3 id="uniq">uniq</h3>

<p>Vergelijkt een lijn met de volgende en gooit dubbels eruit. Instelbaar met een beperkt aantal parameters. <br/><br/>
<strong>adjacent matching lines</strong>, meer kan dit ding niet!</p>

<h5 id="sed-gebruiken-om-uniq-te-emuleren">sed gebruiken om uniq te emuleren</h5>

<p>Zie <a href="http://www.catonmat.net/blog/sed-one-liners-explained-part-three/">http://www.catonmat.net/blog/sed-one-liners-explained-part-three/</a> voor volledige uitleg</p>

<pre><code>sed '$!N; /^&lt;br/&gt;(.*&lt;br/&gt;)&lt;br/&gt;n&lt;br/&gt;1$/!P; D'
</code></pre>

<h5 id="sed-gebruiken-om-álle-dubbels-eruit-te-smijten-buffering">sed gebruiken om álle dubbels eruit te smijten: buffering</h5>

<pre><code>sed -n 'G; s/&lt;br/&gt;n/&amp;&amp;/; /^&lt;br/&gt;([ -~]*&lt;br/&gt;n&lt;br/&gt;).*&lt;br/&gt;n&lt;br/&gt;1/d; s/&lt;br/&gt;n//; h; P'
</code></pre>

<h3 id="cut">cut</h3>

<p>Een utility command dat meestal gebruikt wordt om lijnen op te splitsen afhankelijk van een <strong>delimiter</strong>. Bijvoorbeeld:</p>

<pre><code>cat test.txt | cut -d '|' -f 3
</code></pre>

<p>meest gebruikte opties:</p>

<ul>
<li><code>-d</code> verplicht, geef delimiter op</li>
<li><code>-f</code> selecteer enkel deze kolommen</li>
</ul>

<h3 id="combinatievoorbeeld">Combinatievoorbeeld</h3>

<p>Onderstaand script zoekt in de svn log entries met &lsquo;jira&rsquo; of &lsquo;hel&rsquo; (case insensitive, <code>-i</code> grep operator) behalve &lsquo;gcl&rsquo; of &lsquo;lvm&rsquo;, print context 1 lijn above en 2 lijnen below, filtert dubbels, haalt de derde kolom eruit gesplitst door &lsquo;|&rsquo; (datum), vervangt eender welke hoeveelheid &lsquo;-&rsquo; door niets en wrap datums beginnende met 2011 met twee = tekens.</p>

<pre><code class="language-bash">#!/bin/sh
datefrom=2011-02-28
dateto=2011-03-12
logfile=/cygdrive/c/opt/wamp/www/wiki/data/wiki/helena/svnlog.txt

pushd /cygdrive/c/opt/hudson/jobs/Helena_build/workspace/burgerlijkestand
echo &quot;### Svn log Helena Trunk &quot; &gt; $logfile
echo &quot;❗ periode **[$datefrom - $dateto]**&quot; &gt;&gt; $logfile
echo &quot;#### Helena Jira's via svn log&quot; &gt;&gt; $logfile
svn --username######cp8tsc --passwordq3Sp8Phu log -r{$datefrom}:{$dateto} |
    grep -B 2 -A 1 -i 'HEL-&lt;br/&gt;|jira' |
    grep -v 'gcl&lt;br/&gt;|lvm' |
    sed -e 's/-*//' -e 's/r[0-9]* .*(&lt;br/&gt;(.*&lt;br/&gt;)).*/#####&lt;br/&gt;1/g' -e 's/^&lt;br/&gt;([^=]&lt;br/&gt;)/  *&lt;br/&gt;1/' |
    sed -n 'G; s/&lt;br/&gt;n/&amp;&amp;/; /^&lt;br/&gt;([ -~]*&lt;br/&gt;n&lt;br/&gt;).*&lt;br/&gt;n&lt;br/&gt;1/d; s/&lt;br/&gt;n//; h; P' &gt;&gt; $logfile
popd
</code></pre>

<h1 id="random-commands">Random commands</h1>

<ul>
<li><code>seq 1 10</code> print in een sequence getalletjes.</li>
<li><code>head</code> werkt ook in plaats van <code>tail</code>, maar zelfs van een lijst - ge kunt <code>head 1</code> van een stream dus gebruiken als pop voor een stack.</li>
<li><code>ftp -i -n [host] &lt;&lt; FTP_SCRIPT</code> newline, een hoop commands, en <code>FTP_SCRIPT</code> op het laatste = in 1 regel wat op een ftp server doen.</li>
<li><code>mail -a [attach]</code> = in 1 regel als attach iets mailen naar iemand (zie <code>man</code>)</li>
<li><code>wc</code> ###### wordcount; -e  enkel lijnen</li>
</ul>

      
    </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="https://github.com/wgroeneveld" target="_blank" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
		      
          <li>
            <a href="mailto:wouter.groeneveld@gmail.com" title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
	    	  
          
           
          
          
          
          
          <li>
            <a href="https://www.pinterest.com/woutergroenev" target="_blank" title="Pinterest">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-pinterest fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li>
            <a href="https://www.goodreads.com/user/show/5451893-wouter" target="_blank" title="Goodreads">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-book fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          

    		  <li>
      			<a href="http://www.brainbaking.com/index.xml" title="RSS">
      			  <span class="fa-stack fa-lg">
        				<i class="fa fa-circle fa-stack-2x"></i>
        				<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      			  </span>
      			</a>
    		  </li>		

        </ul>
        <p class="credits copyright text-muted">
    	  Wouter Groeneveld
    	  &nbsp;&bull;&nbsp;
    	  No copyright - <a href="https://github.com/wgroeneveld/brainbaking" target="_blank">Hack away!</a>
    		  
    	  
    	  &nbsp;&bull;&nbsp;
    	  <a href="http://www.brainbaking.com/">
          <i class="fa fa-lightbulb-o" aria-hidden="true"></i>&nbsp;Brain Baking
        </a>
    	  
  	    </p>
  	    
    	<p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.18.1</a> powered &nbsp;&bull;&nbsp; Theme by <a href="https://github.com/halogenica/beautifulhugo" target="_blank">Beautiful Hugo</a> adapted to <a href="https://github.com/wgroeneveld/beautifulbaking">Beautiful Baking</a>
          
    	</p>
      </div>
    </div>
  </div>
</footer>

<script src="http://www.brainbaking.com//js/jquery-1.11.2.min.js"></script>
<script src="http://www.brainbaking.com//js/bootstrap.min.js"></script>
<script src="http://www.brainbaking.com//js/main.js"></script>
<script src="http://www.brainbaking.com/js/highlight.min.js"></script>
<script async defer src="//assets.pinterest.com/js/pinit.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-45748221-1', 'auto');
ga('send', 'pageview');
</script>



  </body>
</html>
